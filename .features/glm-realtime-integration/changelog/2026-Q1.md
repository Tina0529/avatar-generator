# 2026 Q1 变更历史

## 2026-02-22: GLM-Realtime 完整集成

### 新增文件
- `modules/glm-client.js` — GLM WebSocket 客户端
  - PCM 缓冲 + WAV 打包（250ms 间隔）
  - server_vad 自动语音检测
  - function calling 支持（与 Gemini 格式兼容）
- `glm-test.html` — 独立测试页面

### 修改文件
- `index.html`
  - 引擎选择器（Gemini / GLM-Realtime）
  - GLM API Key 输入框（按引擎显示/隐藏）
  - 语音列表动态切换（Gemini 6 种 / GLM 7 种）
  - 播放速度滑块（0.8x - 1.5x）
  - speaking_v2 交替动画支持
  - 所有设置持久化到 localStorage

### Bug 修复
- 修复 ScriptProcessor 回放导致 server_vad 后"滴滴"声（output buffer 清零）
- 修复 session.update 缺少必填字段导致连接断开

### 已知限制
- GLM 仅 7 种语音，不适合所有角色（如星洛）
- 部分语音（female-shaonv）播放偏慢，需调整 playbackRate
